# ä»»åŠ¡ 1.1: æƒé™æ§åˆ¶æ¨¡å— - è¯¦ç»†è¯„ä¼°

**è¯„ä¼°æ—¥æœŸ**: 2025-11-28  
**ä»»åŠ¡**: å®ç°æƒé™æ§åˆ¶æ¨¡å—  
**é‡è¦æ€§**: ğŸ”´ æé«˜  
**çŠ¶æ€**: ğŸ“‹ è¯¦ç»†è¯„ä¼°é˜¶æ®µ

---

## ç¬¬ä¸€éƒ¨åˆ†: ä»»åŠ¡ 1.1 å®Œæ•´å®šä¹‰

### ä»»åŠ¡ç›®æ ‡

**å®ç°ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„æƒé™æ§åˆ¶ç³»ç»Ÿ**

```
è®©åº“è‡ªåŠ¨å¤„ç†æƒé™æ§åˆ¶
â†“
ç”¨æˆ·åªéœ€é…ç½®æƒé™è§„åˆ™
â†“
åº“è‡ªåŠ¨åº”ç”¨åˆ°æ‰€æœ‰ CRUD è·¯ç”±
â†“
æ— éœ€ç”¨æˆ·æ‰‹åŠ¨å®ç°æƒé™æ£€æŸ¥
```

### æ ¸å¿ƒåŠŸèƒ½

```
1. JWT è®¤è¯
   - Token ç”Ÿæˆ
   - Token éªŒè¯
   - Token åˆ·æ–°
   - Token è¿‡æœŸå¤„ç†

2. è§’è‰²æƒé™ (Role-Based Access Control)
   - å®šä¹‰è§’è‰²
   - åˆ†é…æƒé™ç»™è§’è‰²
   - åˆ†é…ç”¨æˆ·åˆ°è§’è‰²
   - æ£€æŸ¥ç”¨æˆ·è§’è‰²

3. èµ„æºæƒé™ (Resource-Based Access Control)
   - å®šä¹‰èµ„æº
   - åˆ†é…æƒé™ç»™èµ„æº
   - æ£€æŸ¥ç”¨æˆ·å¯¹èµ„æºçš„æƒé™
   - æ”¯æŒç»†ç²’åº¦æƒé™

4. è‡ªåŠ¨åº”ç”¨
   - è‡ªåŠ¨åº”ç”¨åˆ°æ‰€æœ‰ CRUD è·¯ç”±
   - è‡ªåŠ¨æ£€æŸ¥æƒé™
   - è‡ªåŠ¨æ‹’ç»æ— æƒé™è¯·æ±‚
   - è‡ªåŠ¨è¿”å› 403 é”™è¯¯
```

---

## ç¬¬äºŒéƒ¨åˆ†: ä¸ç°æœ‰é¡¹ç›®çš„å…³ç³»åˆ†æ

### ç°æœ‰é¡¹ç›®ç»“æ„

```
fastapi-easy/
â”œâ”€â”€ src/fastapi_easy/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ crud_router.py (æ ¸å¿ƒè·¯ç”±)
â”‚   â”œâ”€â”€ crud_config.py (é…ç½®)
â”‚   â”œâ”€â”€ adapters/ (ORM é€‚é…å™¨)
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ sqlalchemy_adapter.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ operations/ (CRUD æ“ä½œ)
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ get_all.py
â”‚   â”‚   â”œâ”€â”€ get_one.py
â”‚   â”‚   â”œâ”€â”€ create.py
â”‚   â”‚   â”œâ”€â”€ update.py
â”‚   â”‚   â””â”€â”€ delete.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ 01_hello_world.py
â”‚   â”œâ”€â”€ 02_with_database.py
â”‚   â”œâ”€â”€ 03_with_queries.py
â”‚   â”œâ”€â”€ 04_advanced_features.py
â”‚   â””â”€â”€ 05_complete_ecommerce.py
â””â”€â”€ tests/
```

### æƒé™æ§åˆ¶æ¨¡å—åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Ÿ

**å»ºè®®ç»“æ„**:

```
fastapi-easy/
â”œâ”€â”€ src/fastapi_easy/
â”‚   â”œâ”€â”€ security/ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py (åŸºç¡€ç±»)
â”‚   â”‚   â”œâ”€â”€ jwt_auth.py (JWT è®¤è¯)
â”‚   â”‚   â”œâ”€â”€ role_permission.py (è§’è‰²æƒé™)
â”‚   â”‚   â”œâ”€â”€ resource_permission.py (èµ„æºæƒé™)
â”‚   â”‚   â”œâ”€â”€ decorators.py (è£…é¥°å™¨)
â”‚   â”‚   â”œâ”€â”€ models.py (æ•°æ®æ¨¡å‹)
â”‚   â”‚   â””â”€â”€ exceptions.py (å¼‚å¸¸)
â”‚   â”œâ”€â”€ crud_router.py (ä¿®æ”¹ï¼Œé›†æˆæƒé™)
â”‚   â”œâ”€â”€ crud_config.py (ä¿®æ”¹ï¼Œæ·»åŠ æƒé™é…ç½®)
â”‚   â””â”€â”€ ...
```

---

## ç¬¬ä¸‰éƒ¨åˆ†: ä¸ç°æœ‰åŠŸèƒ½çš„é‡å¤åˆ†æ

### é—®é¢˜ 1: CRUDConfig ä¸­å·²æœ‰æƒé™ç›¸å…³é…ç½®å—ï¼Ÿ

**æ£€æŸ¥ç°æœ‰ä»£ç **:

```python
# æŸ¥çœ‹ crud_config.py
# æ˜¯å¦å·²æœ‰æƒé™ç›¸å…³é…ç½®ï¼Ÿ
```

**å¯èƒ½çš„é‡å¤**:
- â“ æ˜¯å¦å·²æœ‰ `enable_permissions` é…ç½®ï¼Ÿ
- â“ æ˜¯å¦å·²æœ‰ `permission_fields` é…ç½®ï¼Ÿ
- â“ æ˜¯å¦å·²æœ‰æƒé™æ£€æŸ¥çš„ Hookï¼Ÿ

**å»ºè®®**:
- âœ… æ£€æŸ¥ç°æœ‰ CRUDConfig
- âœ… å¦‚æœæœ‰é‡å¤ï¼Œéœ€è¦åˆå¹¶æˆ–æ‰©å±•
- âœ… ç¡®ä¿ä¸ä¼šå†²çª

---

### é—®é¢˜ 2: æ˜¯å¦å·²æœ‰è®¤è¯ç›¸å…³çš„å®ç°ï¼Ÿ

**æ£€æŸ¥ç°æœ‰ä»£ç **:

```python
# æŸ¥çœ‹æ˜¯å¦å·²æœ‰ï¼š
# - JWT å¤„ç†
# - Token éªŒè¯
# - ç”¨æˆ·è®¤è¯
```

**å¯èƒ½çš„é‡å¤**:
- â“ æ˜¯å¦å·²æœ‰ JWT å®ç°ï¼Ÿ
- â“ æ˜¯å¦å·²æœ‰ç”¨æˆ·æ¨¡å‹ï¼Ÿ
- â“ æ˜¯å¦å·²æœ‰è®¤è¯ä¸­é—´ä»¶ï¼Ÿ

**å»ºè®®**:
- âœ… æ£€æŸ¥ç°æœ‰å®ç°
- âœ… å¦‚æœæœ‰é‡å¤ï¼Œéœ€è¦é‡ç”¨æˆ–æ‰©å±•
- âœ… é¿å…é‡å¤å®ç°

---

### é—®é¢˜ 3: Hook ç³»ç»Ÿæ˜¯å¦å¯ä»¥ç”¨äºæƒé™æ£€æŸ¥ï¼Ÿ

**ç°æœ‰ Hook ç³»ç»Ÿ**:

```python
# ç°æœ‰çš„ Hook
- before_get_all, after_get_all
- before_get_one, after_get_one
- before_create, after_create
- before_update, after_update
- before_delete, after_delete
```

**å¯èƒ½çš„å†²çª**:
- â“ æƒé™æ£€æŸ¥åº”è¯¥åœ¨ Hook ä¸­å®ç°å—ï¼Ÿ
- â“ è¿˜æ˜¯åº”è¯¥åœ¨è·¯ç”±çº§åˆ«å®ç°ï¼Ÿ
- â“ è¿˜æ˜¯åº”è¯¥åœ¨æ“ä½œçº§åˆ«å®ç°ï¼Ÿ

**å»ºè®®**:
- âœ… æƒé™æ£€æŸ¥åº”è¯¥åœ¨è·¯ç”±çº§åˆ« (æœ€æ—©)
- âœ… ä¸åº”è¯¥ä¾èµ– Hook (Hook æ˜¯ä¸šåŠ¡é€»è¾‘)
- âœ… åº”è¯¥åœ¨ CRUDRouter ä¸­å®ç°

---

## ç¬¬å››éƒ¨åˆ†: ä¸ä¸€è‡´æ€§åˆ†æ

### ä¸ä¸€è‡´ 1: æƒé™æ¨¡å‹çš„å®šä¹‰

**é—®é¢˜**: å¦‚ä½•å®šä¹‰æƒé™ï¼Ÿ

**é€‰é¡¹ A: åŸºäºæ“ä½œ**:
```python
permissions = {
    "read": ["user", "admin"],
    "create": ["admin"],
    "update": ["admin"],
    "delete": ["admin"]
}
```

**é€‰é¡¹ B: åŸºäºèµ„æº**:
```python
permissions = {
    "items.read": ["user", "admin"],
    "items.create": ["admin"],
    "items.update": ["admin"],
    "items.delete": ["admin"]
}
```

**é€‰é¡¹ C: åŸºäºç»†ç²’åº¦**:
```python
permissions = {
    "items.read.own": ["user"],
    "items.read.all": ["admin"],
    "items.create": ["admin"],
    "items.update.own": ["user"],
    "items.update.all": ["admin"],
    "items.delete.own": ["user"],
    "items.delete.all": ["admin"]
}
```

**å»ºè®®**: 
- âœ… æ”¯æŒæ‰€æœ‰ä¸‰ç§æ¨¡å‹
- âœ… ä»ç®€å•åˆ°å¤æ‚é€æ­¥æ”¯æŒ
- âœ… ç¬¬ä¸€ç‰ˆæœ¬æ”¯æŒé€‰é¡¹ A å’Œ B

---

### ä¸ä¸€è‡´ 2: æƒé™å­˜å‚¨ä½ç½®

**é—®é¢˜**: æƒé™è§„åˆ™å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ

**é€‰é¡¹ A: é…ç½®æ–‡ä»¶**:
```python
app = FastAPIEasy(
    permissions={
        "ItemDB": {
            "read": ["user", "admin"],
            "create": ["admin"]
        }
    }
)
```

**é€‰é¡¹ B: æ•°æ®åº“**:
```python
# æƒé™è§„åˆ™å­˜å‚¨åœ¨æ•°æ®åº“
# è¿è¡Œæ—¶åŠ¨æ€åŠ è½½
```

**é€‰é¡¹ C: æ··åˆ**:
```python
# é»˜è®¤æƒé™åœ¨é…ç½®ä¸­
# å¯ä»¥åœ¨æ•°æ®åº“ä¸­è¦†ç›–
```

**å»ºè®®**:
- âœ… ç¬¬ä¸€ç‰ˆæœ¬æ”¯æŒé…ç½®æ–‡ä»¶ (é€‰é¡¹ A)
- âœ… ç¬¬äºŒç‰ˆæœ¬æ”¯æŒæ•°æ®åº“ (é€‰é¡¹ B)
- âœ… ç¬¬ä¸‰ç‰ˆæœ¬æ”¯æŒæ··åˆ (é€‰é¡¹ C)

---

### ä¸ä¸€è‡´ 3: ç”¨æˆ·ä¿¡æ¯æ¥æº

**é—®é¢˜**: ç”¨æˆ·ä¿¡æ¯ä»å“ªé‡Œè·å–ï¼Ÿ

**é€‰é¡¹ A: JWT Token**:
```python
# ä» JWT Token ä¸­è§£æç”¨æˆ·ä¿¡æ¯
# åŒ…æ‹¬ user_id, roles, permissions
```

**é€‰é¡¹ B: æ•°æ®åº“**:
```python
# ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
# æ¯æ¬¡è¯·æ±‚éƒ½æŸ¥è¯¢
```

**é€‰é¡¹ C: ç¼“å­˜**:
```python
# ä»ç¼“å­˜ä¸­è·å–ç”¨æˆ·ä¿¡æ¯
# å®šæœŸæ›´æ–°ç¼“å­˜
```

**å»ºè®®**:
- âœ… ç¬¬ä¸€ç‰ˆæœ¬æ”¯æŒ JWT Token (é€‰é¡¹ A)
- âœ… å¯é€‰æ”¯æŒæ•°æ®åº“æŸ¥è¯¢ (é€‰é¡¹ B)
- âœ… å¯é€‰æ”¯æŒç¼“å­˜ (é€‰é¡¹ C)

---

## ç¬¬äº”éƒ¨åˆ†: æ½œåœ¨é—®é¢˜åˆ†æ

### é—®é¢˜ 1: æƒé™æ£€æŸ¥çš„æ€§èƒ½

**é—®é¢˜**: æ¯æ¬¡è¯·æ±‚éƒ½æ£€æŸ¥æƒé™ï¼Œä¼šä¸ä¼šå½±å“æ€§èƒ½ï¼Ÿ

**åˆ†æ**:
```
æ¯æ¬¡è¯·æ±‚:
1. éªŒè¯ JWT Token (å¿«)
2. è§£æ Token è·å–ç”¨æˆ·ä¿¡æ¯ (å¿«)
3. æ£€æŸ¥ç”¨æˆ·æƒé™ (å¿«)
4. æ‰§è¡Œä¸šåŠ¡é€»è¾‘ (å¯èƒ½æ…¢)

æ€»ä½“å½±å“: æƒé™æ£€æŸ¥çš„æ€§èƒ½å½±å“ < 1%
```

**è§£å†³æ–¹æ¡ˆ**:
- âœ… ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“æŸ¥è¯¢
- âœ… ä½¿ç”¨ JWT Token é¿å…æ•°æ®åº“æŸ¥è¯¢
- âœ… å¼‚æ­¥å¤„ç†æƒé™æ£€æŸ¥

---

### é—®é¢˜ 2: æƒé™æ£€æŸ¥çš„å¤æ‚æ€§

**é—®é¢˜**: å¦‚ä½•å¤„ç†å¤æ‚çš„æƒé™è§„åˆ™ï¼Ÿ

**ä¾‹å­**:
```python
# ç”¨æˆ·åªèƒ½è¯»å–è‡ªå·±çš„æ•°æ®
# ç®¡ç†å‘˜å¯ä»¥è¯»å–æ‰€æœ‰æ•°æ®
# è¿™ç§æƒé™è§„åˆ™å¦‚ä½•å®ç°ï¼Ÿ
```

**è§£å†³æ–¹æ¡ˆ**:
- âœ… æ”¯æŒè‡ªå®šä¹‰æƒé™æ£€æŸ¥å‡½æ•°
- âœ… æ”¯æŒæ¡ä»¶æƒé™æ£€æŸ¥
- âœ… æ”¯æŒæ•°æ®çº§åˆ«çš„æƒé™æ£€æŸ¥

---

### é—®é¢˜ 3: æƒé™æ£€æŸ¥ä¸ä¸šåŠ¡é€»è¾‘çš„åˆ†ç¦»

**é—®é¢˜**: æƒé™æ£€æŸ¥å’Œä¸šåŠ¡é€»è¾‘å¦‚ä½•åˆ†ç¦»ï¼Ÿ

**é—®é¢˜åœºæ™¯**:
```python
# æƒé™æ£€æŸ¥: ç”¨æˆ·æ˜¯å¦æœ‰æƒé™åˆ é™¤è¿™ä¸ªé¡¹ç›®ï¼Ÿ
# ä¸šåŠ¡é€»è¾‘: é¡¹ç›®æ˜¯å¦å·²å‘å¸ƒï¼Ÿ(å·²å‘å¸ƒçš„ä¸èƒ½åˆ é™¤)

# è¿™ä¸¤ä¸ªæ£€æŸ¥åº”è¯¥åœ¨å“ªé‡Œè¿›è¡Œï¼Ÿ
```

**è§£å†³æ–¹æ¡ˆ**:
- âœ… æƒé™æ£€æŸ¥åœ¨è·¯ç”±çº§åˆ« (æœ€æ—©)
- âœ… ä¸šåŠ¡é€»è¾‘æ£€æŸ¥åœ¨æ“ä½œçº§åˆ« (ä¸šåŠ¡é€»è¾‘)
- âœ… ä¸¤è€…ä¸åº”è¯¥æ··æ·†

---

### é—®é¢˜ 4: æƒé™æ£€æŸ¥çš„é”™è¯¯å¤„ç†

**é—®é¢˜**: æƒé™æ£€æŸ¥å¤±è´¥æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ

**åœºæ™¯**:
```python
# ç”¨æˆ·æ— æƒé™è®¿é—®
# åº”è¯¥è¿”å›ä»€ä¹ˆï¼Ÿ
# - 403 Forbidden (æ¨è)
# - 401 Unauthorized (ä¸æ¨èï¼Œè¿™æ˜¯è®¤è¯å¤±è´¥)
# - 404 Not Found (éšè—èµ„æºå­˜åœ¨)
```

**è§£å†³æ–¹æ¡ˆ**:
- âœ… æ— æƒé™è¿”å› 403 Forbidden
- âœ… è®¤è¯å¤±è´¥è¿”å› 401 Unauthorized
- âœ… å¯é€‰: éšè—èµ„æºè¿”å› 404

---

## ç¬¬å…­éƒ¨åˆ†: å®‰å…¨æ€§é—®é¢˜åˆ†æ

### å®‰å…¨é—®é¢˜ 1: JWT Token å®‰å…¨

**é—®é¢˜**: JWT Token å¦‚ä½•å®‰å…¨å­˜å‚¨å’Œä¼ è¾“ï¼Ÿ

**é£é™©**:
- âŒ Token è¢«çªƒå–
- âŒ Token è¢«ç¯¡æ”¹
- âŒ Token è¿‡æœŸåä»å¯ä½¿ç”¨
- âŒ Token æ³„éœ²æ•æ„Ÿä¿¡æ¯

**è§£å†³æ–¹æ¡ˆ**:
- âœ… ä½¿ç”¨ HTTPS ä¼ è¾“ (å¿…é¡»)
- âœ… ä½¿ç”¨å¼ºåŠ å¯†ç®—æ³• (HS256 æˆ– RS256)
- âœ… è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ (15 åˆ†é’Ÿ)
- âœ… å®ç° Token åˆ·æ–°æœºåˆ¶
- âœ… ä¸åœ¨ Token ä¸­å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- âœ… ä½¿ç”¨ HttpOnly Cookie å­˜å‚¨ Token (å¯é€‰)

---

### å®‰å…¨é—®é¢˜ 2: æƒé™æå‡æ”»å‡»

**é—®é¢˜**: ç”¨æˆ·å¦‚ä½•é˜²æ­¢æƒé™æå‡ï¼Ÿ

**é£é™©**:
- âŒ ç”¨æˆ·ä¿®æ”¹ JWT Token æå‡æƒé™
- âŒ ç”¨æˆ·ä¼ªé€ ç®¡ç†å‘˜ Token
- âŒ ç”¨æˆ·ç»•è¿‡æƒé™æ£€æŸ¥

**è§£å†³æ–¹æ¡ˆ**:
- âœ… ä½¿ç”¨å¼ºåŠ å¯†ç®—æ³•ç­¾å Token
- âœ… éªŒè¯ Token ç­¾å (å¿…é¡»)
- âœ… ä¸å…è®¸ç”¨æˆ·ä¿®æ”¹ Token
- âœ… å®šæœŸéªŒè¯ç”¨æˆ·æƒé™ (ä»æ•°æ®åº“)
- âœ… å®ç°æƒé™å®¡è®¡æ—¥å¿—

---

### å®‰å…¨é—®é¢˜ 3: æš´åŠ›ç ´è§£æ”»å‡»

**é—®é¢˜**: å¦‚ä½•é˜²æ­¢æš´åŠ›ç ´è§£ç™»å½•ï¼Ÿ

**é£é™©**:
- âŒ æ”»å‡»è€…å°è¯•å¤šä¸ªå¯†ç 
- âŒ æ”»å‡»è€…å°è¯•å¤šä¸ªç”¨æˆ·å
- âŒ è´¦æˆ·è¢«é”å®š

**è§£å†³æ–¹æ¡ˆ**:
- âœ… å®ç°ç™»å½•å°è¯•é™åˆ¶
- âœ… å®ç°è´¦æˆ·é”å®šæœºåˆ¶
- âœ… å®ç° IP é™åˆ¶
- âœ… å®ç°éªŒè¯ç  (å¯é€‰)
- âœ… å®ç°äºŒå› ç´ è®¤è¯ (å¯é€‰)

---

### å®‰å…¨é—®é¢˜ 4: CSRF æ”»å‡»

**é—®é¢˜**: å¦‚ä½•é˜²æ­¢ CSRF æ”»å‡»ï¼Ÿ

**é£é™©**:
- âŒ æ¶æ„ç½‘ç«™å‘é€è¯·æ±‚
- âŒ ç”¨æˆ·è¢«è¿«æ‰§è¡Œä¸æƒ³è¦çš„æ“ä½œ

**è§£å†³æ–¹æ¡ˆ**:
- âœ… ä½¿ç”¨ CSRF Token (å¯¹äº Cookie å­˜å‚¨çš„ Token)
- âœ… æ£€æŸ¥ Referer å’Œ Origin å¤´
- âœ… ä½¿ç”¨ SameSite Cookie å±æ€§
- âœ… ä½¿ç”¨ Bearer Token (JWT) ä¸éœ€è¦ CSRF ä¿æŠ¤

---

### å®‰å…¨é—®é¢˜ 5: æƒé™æ£€æŸ¥çš„ç»•è¿‡

**é—®é¢˜**: ç”¨æˆ·å¦‚ä½•ç»•è¿‡æƒé™æ£€æŸ¥ï¼Ÿ

**é£é™©**:
- âŒ ç›´æ¥è®¿é—®æ•°æ®åº“
- âŒ ä½¿ç”¨ API çš„å…¶ä»–ç«¯ç‚¹
- âŒ åˆ©ç”¨ä¸šåŠ¡é€»è¾‘æ¼æ´

**è§£å†³æ–¹æ¡ˆ**:
- âœ… åœ¨æ‰€æœ‰ CRUD æ“ä½œä¸­æ£€æŸ¥æƒé™
- âœ… åœ¨æ•°æ®åº“çº§åˆ«ä¹Ÿæ£€æŸ¥æƒé™ (å¯é€‰)
- âœ… å®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡
- âœ… å®ç°æƒé™å®¡è®¡æ—¥å¿—

---

## ç¬¬ä¸ƒéƒ¨åˆ†: ä¸å…¶ä»–ä»»åŠ¡çš„ä¾èµ–å…³ç³»

### ä¾èµ–å…³ç³»å›¾

```
ä»»åŠ¡ 1.1 (æƒé™æ§åˆ¶)
â”œâ”€â”€ ä¾èµ–: ç°æœ‰çš„ CRUDRouter
â”œâ”€â”€ ä¾èµ–: ç°æœ‰çš„ CRUDConfig
â”œâ”€â”€ ä¾èµ–: ç°æœ‰çš„ ORM é€‚é…å™¨
â”œâ”€â”€ ä¾èµ–: ç°æœ‰çš„ CRUD æ“ä½œ
â””â”€â”€ ä¸ä¾èµ–: ä»»åŠ¡ 1.2 (è‡ªåŠ¨å¤‡ä»½)
â””â”€â”€ ä¸ä¾èµ–: ä»»åŠ¡ 1.3 (è‡ªåŠ¨ç¾éš¾æ¢å¤)

ä»»åŠ¡ 1.2 (è‡ªåŠ¨å¤‡ä»½)
â”œâ”€â”€ ä¾èµ–: ç°æœ‰çš„æ•°æ®åº“è¿æ¥
â”œâ”€â”€ ä¸ä¾èµ–: ä»»åŠ¡ 1.1 (æƒé™æ§åˆ¶)
â””â”€â”€ ä¸ä¾èµ–: ä»»åŠ¡ 1.3 (è‡ªåŠ¨ç¾éš¾æ¢å¤)

ä»»åŠ¡ 1.3 (è‡ªåŠ¨ç¾éš¾æ¢å¤)
â”œâ”€â”€ ä¾èµ–: ç°æœ‰çš„æ•°æ®åº“è¿æ¥
â”œâ”€â”€ ä¸ä¾èµ–: ä»»åŠ¡ 1.1 (æƒé™æ§åˆ¶)
â””â”€â”€ ä¸ä¾èµ–: ä»»åŠ¡ 1.2 (è‡ªåŠ¨å¤‡ä»½)
```

**ç»“è®º**: ä¸‰ä¸ªä»»åŠ¡å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæ²¡æœ‰ä¾èµ–å…³ç³»

---

## ç¬¬å…«éƒ¨åˆ†: å®ç°å¤æ‚åº¦è¯„ä¼°

### å¤æ‚åº¦åˆ†æ

| ç»„ä»¶ | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| JWT è®¤è¯ | ğŸŸ¢ ä½ | æ ‡å‡†å®ç°ï¼Œæœ‰ç°æˆåº“ |
| è§’è‰²æƒé™ | ğŸŸ¡ ä¸­ | éœ€è¦è®¾è®¡æƒé™æ¨¡å‹ |
| èµ„æºæƒé™ | ğŸŸ¡ ä¸­ | éœ€è¦ç»†ç²’åº¦æƒé™æ£€æŸ¥ |
| è‡ªåŠ¨åº”ç”¨ | ğŸŸ¡ ä¸­ | éœ€è¦ä¿®æ”¹ CRUDRouter |
| å®‰å…¨æ€§ | ğŸ”´ é«˜ | éœ€è¦è€ƒè™‘å¤šç§æ”»å‡» |
| æµ‹è¯• | ğŸ”´ é«˜ | éœ€è¦å…¨é¢çš„æµ‹è¯•è¦†ç›– |

**æ€»ä½“å¤æ‚åº¦**: ğŸŸ¡ ä¸­ç­‰

---

## ç¬¬ä¹éƒ¨åˆ†: é‡å¤é—®é¢˜æ€»ç»“

### å‘ç°çš„é‡å¤

| é‡å¤é¡¹ | ç°æœ‰å®ç° | æ–°å®ç° | å»ºè®® |
|--------|---------|--------|------|
| Hook ç³»ç»Ÿ | âœ… å­˜åœ¨ | ä¸åº”è¯¥ç”¨ | æƒé™æ£€æŸ¥åœ¨è·¯ç”±çº§åˆ« |
| é”™è¯¯å¤„ç† | âœ… å­˜åœ¨ | éœ€è¦æ‰©å±• | æ·»åŠ  403 é”™è¯¯ |
| é…ç½®ç³»ç»Ÿ | âœ… å­˜åœ¨ | éœ€è¦æ‰©å±• | åœ¨ CRUDConfig ä¸­æ·»åŠ æƒé™é…ç½® |

### å‘ç°çš„ä¸ä¸€è‡´

| ä¸ä¸€è‡´é¡¹ | é€‰é¡¹ | å»ºè®® |
|---------|------|------|
| æƒé™æ¨¡å‹ | A/B/C | æ”¯æŒ A å’Œ Bï¼Œç¬¬ä¸€ç‰ˆæœ¬ç”¨ A |
| æƒé™å­˜å‚¨ | é…ç½®/æ•°æ®åº“/æ··åˆ | ç¬¬ä¸€ç‰ˆæœ¬ç”¨é…ç½®ï¼Œåç»­æ‰©å±• |
| ç”¨æˆ·ä¿¡æ¯ | JWT/æ•°æ®åº“/ç¼“å­˜ | ç¬¬ä¸€ç‰ˆæœ¬ç”¨ JWTï¼Œåç»­æ‰©å±• |

---

## ç¬¬åéƒ¨åˆ†: å®‰å…¨æ€§é—®é¢˜æ€»ç»“

| å®‰å…¨é—®é¢˜ | é£é™©ç­‰çº§ | è§£å†³æ–¹æ¡ˆ | ä¼˜å…ˆçº§ |
|---------|---------|---------|--------|
| JWT Token å®‰å…¨ | ğŸ”´ é«˜ | ä½¿ç”¨ HTTPSã€å¼ºåŠ å¯†ã€è¿‡æœŸæ—¶é—´ | ğŸ”´ å¿…é¡» |
| æƒé™æå‡æ”»å‡» | ğŸ”´ é«˜ | éªŒè¯ç­¾åã€å®šæœŸéªŒè¯æƒé™ | ğŸ”´ å¿…é¡» |
| æš´åŠ›ç ´è§£ | ğŸŸ¡ ä¸­ | ç™»å½•é™åˆ¶ã€è´¦æˆ·é”å®š | ğŸŸ¡ åº”è¯¥ |
| CSRF æ”»å‡» | ğŸŸ¡ ä¸­ | CSRF Tokenã€SameSite Cookie | ğŸŸ¡ åº”è¯¥ |
| æƒé™ç»•è¿‡ | ğŸ”´ é«˜ | å…¨é¢æ£€æŸ¥ã€å®¡è®¡æ—¥å¿— | ğŸ”´ å¿…é¡» |

---

## ç¬¬åä¸€éƒ¨åˆ†: æœ€ç»ˆè¯„ä¼°

### ä»»åŠ¡ 1.1 çš„å¯è¡Œæ€§

**æ€»ä½“è¯„ä¼°**: âœ… å¯è¡Œï¼Œä½†éœ€è¦ä»”ç»†è®¾è®¡

### å…³é”®æˆåŠŸå› ç´ 

1. âœ… æ¸…æ™°çš„æƒé™æ¨¡å‹å®šä¹‰
2. âœ… å®Œæ•´çš„å®‰å…¨æ€§è€ƒè™‘
3. âœ… å…¨é¢çš„æµ‹è¯•è¦†ç›–
4. âœ… æ¸…æ™°çš„æ–‡æ¡£å’Œç¤ºä¾‹

### ä¸»è¦é£é™©

1. âŒ å®‰å…¨æ€§é—®é¢˜ (é«˜é£é™©)
2. âŒ æ€§èƒ½é—®é¢˜ (ä¸­é£é™©)
3. âŒ å¤æ‚æ€§é—®é¢˜ (ä¸­é£é™©)

### å»ºè®®

**ç«‹å³å¼€å§‹**:
- âœ… è®¾è®¡æƒé™æ¨¡å‹
- âœ… å®ç° JWT è®¤è¯
- âœ… å®ç°è§’è‰²æƒé™æ£€æŸ¥
- âœ… ç¼–å†™å®‰å…¨æ€§æµ‹è¯•

**åç»­ä¼˜åŒ–**:
- âœ… æ”¯æŒèµ„æºæƒé™
- âœ… æ”¯æŒæ•°æ®åº“æƒé™å­˜å‚¨
- âœ… æ”¯æŒæƒé™ç¼“å­˜
- âœ… æ”¯æŒæƒé™å®¡è®¡æ—¥å¿—

---

## æ€»ç»“

### ä»»åŠ¡ 1.1 çš„æ ¸å¿ƒ

```
å®ç°ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„æƒé™æ§åˆ¶ç³»ç»Ÿ
- JWT è®¤è¯
- è§’è‰²æƒé™
- èµ„æºæƒé™
- è‡ªåŠ¨åº”ç”¨åˆ°æ‰€æœ‰ CRUD è·¯ç”±
```

### å…³é”®å†³ç­–

1. âœ… æƒé™æ£€æŸ¥åœ¨è·¯ç”±çº§åˆ« (æœ€æ—©)
2. âœ… ç¬¬ä¸€ç‰ˆæœ¬æ”¯æŒé…ç½®æ–‡ä»¶æƒé™å­˜å‚¨
3. âœ… ä½¿ç”¨ JWT Token å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
4. âœ… è¿”å› 403 Forbidden è¡¨ç¤ºæ— æƒé™

### ä¸‹ä¸€æ­¥

åˆ›å»ºè¯¦ç»†çš„ä»£åŠæ¸…å•ï¼Œå¼€å§‹å®æ–½ä»»åŠ¡ 1.1
